# STEPS to add new local domain:
# 1. cd ~/dotfiles/scripts && localdev -h


<VirtualHost *:80>
    ServerName hobbysew.test
    ServerAlias www.hobbysew.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName hobbysew.test
    ServerAlias www.hobbysew.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://localhost:44323/
    ProxyPassReverse / https://localhost:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/hobbysew.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/hobbysew.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


<VirtualHost *:80>
    ServerName cms.hobbysew.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/
</VirtualHost>
<VirtualHost *:443>
    ServerName cms.hobbysew.test

    ProxyPreserveHost On
    ProxyRequests Off

    ProxyPassMatch      ^/_blazor/(.*) https://localhost:5000/_blazor/$1
    ProxyPass           /_blazor wss://localhost:5000/_blazor

    # Root proxy (must come after specific paths)
    ProxyPass / https://localhost:5001/
    ProxyPassReverse / https://localhost:5001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/hobbysew.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/hobbysew.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off

    # Enable WebSocket proxying
    RewriteEngine on
    RewriteCond %{HTTP:UPGRADE} ^WebSocket$ [NC]
    RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
    RewriteRule .* ws://localhost:44323%{REQUEST_URI} [P]

</VirtualHost>



<VirtualHost *:80>
    ServerName horn.test
    ServerAlias www.horn.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName horn.test
    ServerAlias www.horn.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://localhost:44323/
    ProxyPassReverse / https://localhost:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/horn.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/horn.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


<VirtualHost *:80>
    ServerName cms.horn.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/
</VirtualHost>
<VirtualHost *:443>
    ServerName cms.horn.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://localhost:5001/
    ProxyPassReverse / https://localhost:5001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/horn.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/horn.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off

    ProxyPassMatch      ^/_blazor/(.*) http://localhost:5001/_blazor/$1
    ProxyPass           /_blazor ws://localhost:5001/_blazor

    # Enable WebSocket proxying
    RewriteEngine on
    RewriteCond %{HTTP:UPGRADE} ^WebSocket$ [NC]
    RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
    RewriteRule .* ws://localhost:44323%{REQUEST_URI} [P]
</VirtualHost>



# gasstation.test - Added by localdev script
<VirtualHost *:80>
    ServerName gasstation.test
    ServerAlias www.gasstation.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:8001/
    ProxyPassReverse / http://127.0.0.1:8001/
</VirtualHost>
<VirtualHost *:443>
    ServerName gasstation.test
    ServerAlias www.gasstation.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / http://127.0.0.1:8001/
    ProxyPassReverse / http://127.0.0.1:8001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/gasstation.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/gasstation.test.key"
</VirtualHost>


# elna.test - Added by localdev script
<VirtualHost *:80>
    ServerName elna.test
    ServerAlias www.elna.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName elna.test
    ServerAlias www.elna.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://127.0.0.1:44323/
    ProxyPassReverse / https://127.0.0.1:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/elna.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/elna.test.key"
    # Enable SSL for the backend (Apache's connection to your app)
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


# elnamachine.test - Added by localdev script
<VirtualHost *:80>
    ServerName elnamachine.test
    ServerAlias www.elnamachine.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName elnamachine.test
    ServerAlias www.elnamachine.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://127.0.0.1:44323/
    ProxyPassReverse / https://127.0.0.1:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/elnamachine.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/elnamachine.test.key"
    # Enable SSL for the backend (Apache's connection to your app)
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


# cms.elna.test - Added by localdev script
<VirtualHost *:80>
    ServerName cms.elna.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/
</VirtualHost>
<VirtualHost *:443>
    ServerName cms.elna.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://127.0.0.1:5001/
    ProxyPassReverse / https://127.0.0.1:5001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/elna.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/elna.test.key"
    # Enable SSL for the backend (Apache's connection to your app)
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


# cms.elnamachines.test - Added by localdev script
<VirtualHost *:80>
    ServerName cms.elnamachines.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/
</VirtualHost>
<VirtualHost *:443>
    ServerName cms.elnamachines.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://127.0.0.1:5001/
    ProxyPassReverse / https://127.0.0.1:5001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/elnamachines.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/elnamachines.test.key"
    # Enable SSL for the backend (Apache's connection to your app)
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


# sewingmachines.test - Added by localdev script
<VirtualHost *:80>
    ServerName sewingmachines.test
    ServerAlias www.sewingmachines.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName sewingmachines.test
    ServerAlias www.sewingmachines.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://127.0.0.1:44323/
    ProxyPassReverse / https://127.0.0.1:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/sewingmachines.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/sewingmachines.test.key"
    # Enable SSL for the backend (Apache's connection to your app)
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


# sewingmachines.hobbysew.test - Added by localdev script
<VirtualHost *:80>
    ServerName sewingmachines.hobbysew.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName sewingmachines.hobbysew.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://127.0.0.1:44323/
    ProxyPassReverse / https://127.0.0.1:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/hobbysew.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/hobbysew.test.key"
    # Enable SSL for the backend (Apache's connection to your app)
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


# sewingmachines.test - Added by localdev script
<VirtualHost *:80>
    ServerName sewingmachines.test
    ServerAlias www.sewingmachines.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName sewingmachines.test
    ServerAlias www.sewingmachines.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://127.0.0.1:44323/
    ProxyPassReverse / https://127.0.0.1:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/sewingmachines.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/sewingmachines.test.key"
    # Enable SSL for the backend (Apache's connection to your app)
    SSLProxyEngine on
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>
