# STEPS to add new local domain:
# 1. cd ~/dotfiles/scripts && localdev -h


<VirtualHost *:80>
    ServerName hobbysew.test
    ServerAlias www.hobbysew.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName hobbysew.test
    ServerAlias www.hobbysew.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://localhost:44323/
    ProxyPassReverse / https://localhost:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/hobbysew.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/hobbysew.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


<VirtualHost *:80>
    ServerName cms.hobbysew.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/
</VirtualHost>
<VirtualHost *:443>
    ServerName cms.hobbysew.test

    ProxyPreserveHost On
    ProxyRequests Off

    ProxyPassMatch      ^/_blazor/(.*) https://localhost:5000/_blazor/$1
    ProxyPass           /_blazor wss://localhost:5000/_blazor

    # Root proxy (must come after specific paths)
    ProxyPass / https://localhost:5001/
    ProxyPassReverse / https://localhost:5001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/hobbysew.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/hobbysew.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>



<VirtualHost *:80>
    ServerName horn.test
    ServerAlias www.horn.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:44323/
    ProxyPassReverse / http://127.0.0.1:44323/
</VirtualHost>
<VirtualHost *:443>
    ServerName horn.test
    ServerAlias www.horn.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://localhost:44323/
    ProxyPassReverse / https://localhost:44323/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/horn.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/horn.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off
</VirtualHost>


<VirtualHost *:80>
    ServerName cms.horn.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/
</VirtualHost>
<VirtualHost *:443>
    ServerName cms.horn.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / https://localhost:5001/
    ProxyPassReverse / https://localhost:5001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/horn.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/horn.test.key"

    # Enable SSL for the backend (Apache's connection to your .NET app)
    SSLProxyEngine on
    # This is very important for localhost connections to prevent certificate validation errors
    # If your .NET server has a valid certificate, you can remove these
    SSLProxyVerify none
    SSLProxyCheckPeerCN off
    SSLProxyCheckPeerName off

    ProxyPassMatch      ^/_blazor/(.*) http://localhost:5001/_blazor/$1
    ProxyPass           /_blazor ws://localhost:5001/_blazor
</VirtualHost>



# gasstation.test - Added by localdev script
<VirtualHost *:80>
    ServerName gasstation.test
    ServerAlias www.gasstation.test
    ProxyPreserveHost On
    ProxyPass / http://127.0.0.1:8001/
    ProxyPassReverse / http://127.0.0.1:8001/
</VirtualHost>
<VirtualHost *:443>
    ServerName gasstation.test
    ServerAlias www.gasstation.test

    ProxyPreserveHost On
    ProxyRequests Off
    ProxyPass / http://127.0.0.1:8001/
    ProxyPassReverse / http://127.0.0.1:8001/

    # Enable SSL for the frontend (the browser's connection to Apache)
    SSLEngine on
    SSLCertificateFile "/private/etc/apache2/ssl/gasstation.test.crt"
    SSLCertificateKeyFile "/private/etc/apache2/ssl/gasstation.test.key"
</VirtualHost>
